{"version":3,"file":"reason.cjs","sources":["../../../../../../../../src/mods/tor/binary/cells/relayed/relay_end/reason.ts"],"sourcesContent":["import { Binary } from \"libs/binary.js\";\nimport { dateToTtl, ttlToDate } from \"libs/time.js\";\nimport { Address4, Address6 } from \"mods/tor/binary/address.js\";\n\nexport type RelayEndReason =\n  | RelayEndReasonExitPolicy\n  | RelayEndReasonOther\n\nexport class RelayEndReasonOther {\n  readonly class = RelayEndReasonOther\n\n  constructor(\n    readonly id: number\n  ) { }\n\n  write(binary: Binary) { }\n}\n\nexport class RelayEndReasonExitPolicy {\n  readonly class = RelayEndReasonExitPolicy\n\n  static id = 4\n\n  constructor(\n    readonly address: Address4 | Address6,\n    readonly ttl: Date\n  ) { }\n\n  get id() {\n    return this.class.id\n  }\n\n  write(binary: Binary) {\n    this.address.write(binary)\n    binary.writeUint32(dateToTtl(this.ttl))\n  }\n\n  static read(binary: Binary) {\n    const address = binary.remaining === 8\n      ? Address4.read(binary)\n      : Address6.read(binary)\n\n    const ttl = ttlToDate(binary.readUint32())\n\n    return new this(address, ttl)\n  }\n}"],"names":["dateToTtl","address","Address4","Address6","ttlToDate"],"mappings":";;;;;MAQa,mBAAmB,CAAA;AAG9B,IAAA,WAAA,CACW,EAAU,EAAA;QAAV,IAAE,CAAA,EAAA,GAAF,EAAE,CAAQ;QAHZ,IAAK,CAAA,KAAA,GAAG,mBAAmB,CAAA;KAI/B;IAEL,KAAK,CAAC,MAAc,EAAA,GAAK;AAC1B,CAAA;MAEY,wBAAwB,CAAA;IAKnC,WACW,CAAA,OAA4B,EAC5B,GAAS,EAAA;QADT,IAAO,CAAA,OAAA,GAAP,OAAO,CAAqB;QAC5B,IAAG,CAAA,GAAA,GAAH,GAAG,CAAM;QANX,IAAK,CAAA,KAAA,GAAG,wBAAwB,CAAA;KAOpC;AAEL,IAAA,IAAI,EAAE,GAAA;AACJ,QAAA,OAAO,IAAI,CAAC,KAAK,CAAC,EAAE,CAAA;KACrB;AAED,IAAA,KAAK,CAAC,MAAc,EAAA;AAClB,QAAA,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,CAAA;QAC1B,MAAM,CAAC,WAAW,CAACA,cAAS,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAA;KACxC;IAED,OAAO,IAAI,CAAC,MAAc,EAAA;AACxB,QAAA,MAAMC,SAAO,GAAG,MAAM,CAAC,SAAS,KAAK,CAAC;AACpC,cAAEC,gBAAQ,CAAC,IAAI,CAAC,MAAM,CAAC;AACvB,cAAEC,gBAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;QAEzB,MAAM,GAAG,GAAGC,cAAS,CAAC,MAAM,CAAC,UAAU,EAAE,CAAC,CAAA;AAE1C,QAAA,OAAO,IAAI,IAAI,CAACH,SAAO,EAAE,GAAG,CAAC,CAAA;KAC9B;;AAxBM,wBAAE,CAAA,EAAA,GAAG,CAAC;;;;;"}