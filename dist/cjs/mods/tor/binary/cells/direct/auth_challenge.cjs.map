{"version":3,"file":"auth_challenge.cjs","sources":["../../../../../../../src/mods/tor/binary/cells/direct/auth_challenge.ts"],"sourcesContent":["import { Binary } from \"libs/binary.js\"\nimport { NewCell } from \"mods/tor/binary/cells/cell.js\"\n\nexport class AuthChallengeCell {\n  readonly class = AuthChallengeCell\n\n  static command = 130\n\n  constructor(\n    readonly circuit: undefined,\n    readonly challenge: Buffer,\n    readonly methods: number[]\n  ) { }\n\n  pack() {\n    return this.cell().pack()\n  }\n\n  cell(): NewCell {\n    throw new Error(`Unimplemented`)\n  }\n\n  static uncell(cell: NewCell) {\n    if (cell.command !== this.command)\n      throw new Error(`Invalid AUTH_CHALLENGE cell command ${cell.command}`)\n    if (cell.circuit)\n      throw new Error(`Can't uncell DESTROY cell on circuit > 0`)\n\n    const binary = new Binary(cell.payload)\n\n    const challenge = binary.read(32)\n    const nmethods = binary.readUint16()\n    const methods = new Array<number>(nmethods)\n\n    for (let i = 0; i < nmethods; i++)\n      methods[i] = binary.readUint16()\n\n    return new this(cell.circuit, challenge, methods)\n  }\n}"],"names":["binary","Binary"],"mappings":";;;;MAGa,iBAAiB,CAAA;AAK5B,IAAA,WAAA,CACW,OAAkB,EAClB,SAAiB,EACjB,OAAiB,EAAA;QAFjB,IAAO,CAAA,OAAA,GAAP,OAAO,CAAW;QAClB,IAAS,CAAA,SAAA,GAAT,SAAS,CAAQ;QACjB,IAAO,CAAA,OAAA,GAAP,OAAO,CAAU;QAPnB,IAAK,CAAA,KAAA,GAAG,iBAAiB,CAAA;KAQ7B;IAEL,IAAI,GAAA;AACF,QAAA,OAAO,IAAI,CAAC,IAAI,EAAE,CAAC,IAAI,EAAE,CAAA;KAC1B;IAED,IAAI,GAAA;AACF,QAAA,MAAM,IAAI,KAAK,CAAC,CAAA,aAAA,CAAe,CAAC,CAAA;KACjC;IAED,OAAO,MAAM,CAAC,IAAa,EAAA;AACzB,QAAA,IAAI,IAAI,CAAC,OAAO,KAAK,IAAI,CAAC,OAAO;YAC/B,MAAM,IAAI,KAAK,CAAC,CAAA,oCAAA,EAAuC,IAAI,CAAC,OAAO,CAAE,CAAA,CAAC,CAAA;QACxE,IAAI,IAAI,CAAC,OAAO;AACd,YAAA,MAAM,IAAI,KAAK,CAAC,CAAA,wCAAA,CAA0C,CAAC,CAAA;QAE7D,MAAMA,QAAM,GAAG,IAAIC,aAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAA;QAEvC,MAAM,SAAS,GAAGD,QAAM,CAAC,IAAI,CAAC,EAAE,CAAC,CAAA;AACjC,QAAA,MAAM,QAAQ,GAAGA,QAAM,CAAC,UAAU,EAAE,CAAA;AACpC,QAAA,MAAM,OAAO,GAAG,IAAI,KAAK,CAAS,QAAQ,CAAC,CAAA;QAE3C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,EAAE,CAAC,EAAE;YAC/B,OAAO,CAAC,CAAC,CAAC,GAAGA,QAAM,CAAC,UAAU,EAAE,CAAA;QAElC,OAAO,IAAI,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,SAAS,EAAE,OAAO,CAAC,CAAA;KAClD;;AAhCM,iBAAO,CAAA,OAAA,GAAG,GAAG;;;;"}