{"version":3,"file":"padding_negotiate.cjs","sources":["../../../../../../../src/mods/tor/binary/cells/direct/padding_negotiate.ts"],"sourcesContent":["import { Binary } from \"libs/binary.js\"\nimport { NewCell } from \"mods/tor/binary/cells/cell.js\"\nimport { InvalidCircuit, InvalidCommand } from \"mods/tor/binary/cells/errors.js\"\nimport { PAYLOAD_LEN } from \"mods/tor/constants.js\"\n\nexport class PaddingNegociateCell {\n  readonly class = PaddingNegociateCell\n\n  static command = 12\n\n  static versions = {\n    ZERO: 0\n  }\n\n  static commands = {\n    STOP: 1,\n    START: 2\n  }\n\n  constructor(\n    readonly circuit: undefined,\n    readonly version: number,\n    readonly pcommand: number,\n    readonly ito_low_ms: number,\n    readonly ito_high_ms: number\n  ) { }\n\n  pack() {\n    return this.cell().pack()\n  }\n\n  cell() {\n    const binary = Binary.allocUnsafe(PAYLOAD_LEN)\n\n    binary.writeUint8(this.version)\n    binary.writeUint8(this.pcommand)\n    binary.writeUint16(this.ito_low_ms)\n    binary.writeUint16(this.ito_high_ms)\n    binary.fill()\n\n    return new NewCell(this.circuit, this.class.command, binary.buffer)\n  }\n\n  static uncell(cell: NewCell) {\n    if (cell.command !== this.command)\n      throw new InvalidCommand(this.name, cell.command)\n    if (cell.circuit)\n      throw new InvalidCircuit(this.name, cell.circuit)\n\n    const binary = new Binary(cell.payload)\n\n    const version = binary.readUint8()\n    const pcommand = binary.readUint8()\n    const ito_low_ms = binary.readUint16()\n    const ito_high_ms = binary.readUint16()\n\n    return new this(cell.circuit, version, pcommand, ito_low_ms, ito_high_ms)\n  }\n}"],"names":["binary","Binary","PAYLOAD_LEN","NewCell","InvalidCommand","InvalidCircuit"],"mappings":";;;;;;;MAKa,oBAAoB,CAAA;IAc/B,WACW,CAAA,OAAkB,EAClB,OAAe,EACf,QAAgB,EAChB,UAAkB,EAClB,WAAmB,EAAA;QAJnB,IAAO,CAAA,OAAA,GAAP,OAAO,CAAW;QAClB,IAAO,CAAA,OAAA,GAAP,OAAO,CAAQ;QACf,IAAQ,CAAA,QAAA,GAAR,QAAQ,CAAQ;QAChB,IAAU,CAAA,UAAA,GAAV,UAAU,CAAQ;QAClB,IAAW,CAAA,WAAA,GAAX,WAAW,CAAQ;QAlBrB,IAAK,CAAA,KAAA,GAAG,oBAAoB,CAAA;KAmBhC;IAEL,IAAI,GAAA;AACF,QAAA,OAAO,IAAI,CAAC,IAAI,EAAE,CAAC,IAAI,EAAE,CAAA;KAC1B;IAED,IAAI,GAAA;QACF,MAAMA,QAAM,GAAGC,aAAM,CAAC,WAAW,CAACC,qBAAW,CAAC,CAAA;AAE9C,QAAAF,QAAM,CAAC,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,CAAA;AAC/B,QAAAA,QAAM,CAAC,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;AAChC,QAAAA,QAAM,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAA;AACnC,QAAAA,QAAM,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,CAAA;QACpCA,QAAM,CAAC,IAAI,EAAE,CAAA;AAEb,QAAA,OAAO,IAAIG,YAAO,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,EAAEH,QAAM,CAAC,MAAM,CAAC,CAAA;KACpE;IAED,OAAO,MAAM,CAAC,IAAa,EAAA;AACzB,QAAA,IAAI,IAAI,CAAC,OAAO,KAAK,IAAI,CAAC,OAAO;YAC/B,MAAM,IAAII,qBAAc,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,OAAO,CAAC,CAAA;QACnD,IAAI,IAAI,CAAC,OAAO;YACd,MAAM,IAAIC,qBAAc,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,OAAO,CAAC,CAAA;QAEnD,MAAML,QAAM,GAAG,IAAIC,aAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAA;AAEvC,QAAA,MAAM,OAAO,GAAGD,QAAM,CAAC,SAAS,EAAE,CAAA;AAClC,QAAA,MAAM,QAAQ,GAAGA,QAAM,CAAC,SAAS,EAAE,CAAA;AACnC,QAAA,MAAM,UAAU,GAAGA,QAAM,CAAC,UAAU,EAAE,CAAA;AACtC,QAAA,MAAM,WAAW,GAAGA,QAAM,CAAC,UAAU,EAAE,CAAA;AAEvC,QAAA,OAAO,IAAI,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,OAAO,EAAE,QAAQ,EAAE,UAAU,EAAE,WAAW,CAAC,CAAA;KAC1E;;AAjDM,oBAAO,CAAA,OAAA,GAAG,EAAE,CAAA;AAEZ,oBAAA,CAAA,QAAQ,GAAG;AAChB,IAAA,IAAI,EAAE,CAAC;CACR,CAAA;AAEM,oBAAA,CAAA,QAAQ,GAAG;AAChB,IAAA,IAAI,EAAE,CAAC;AACP,IAAA,KAAK,EAAE,CAAC;CACT;;;;"}