{"version":3,"file":"authorities.cjs","sources":["../../../../../src/mods/tor/consensus/authorities.ts"],"sourcesContent":["/**\n * Tor: src/app/config/auth_dirs.inc\n */\nexport const auth_dirs = `\n\"moria1 orport=9101 \"\n  \"v3ident=D586D18309DED4CD6D57C18FDB97EFA96D330566 \"\n  \"128.31.0.39:9131 9695 DFC3 5FFE B861 329B 9F1A B04C 4639 7020 CE31\",\n\"tor26 orport=443 \"\n  \"v3ident=14C131DFC5C6F93646BE72FA1401C02A8DF2E8B4 \"\n  \"ipv6=[2001:858:2:2:aabb:0:563b:1526]:443 \"\n  \"86.59.21.38:80 847B 1F85 0344 D787 6491 A548 92F9 0493 4E4E B85D\",\n\"dizum orport=443 \"\n  \"v3ident=E8A9C45EDE6D711294FADF8E7951F4DE6CA56B58 \"\n  \"45.66.33.45:80 7EA6 EAD6 FD83 083C 538F 4403 8BBF A077 587D D755\",\n\"Serge orport=9001 bridge \"\n  \"66.111.2.131:9030 BA44 A889 E64B 93FA A2B1 14E0 2C2A 279A 8555 C533\",\n\"gabelmoo orport=443 \"\n  \"v3ident=ED03BB616EB2F60BEC80151114BB25CEF515B226 \"\n  \"ipv6=[2001:638:a000:4140::ffff:189]:443 \"\n  \"131.188.40.189:80 F204 4413 DAC2 E02E 3D6B CF47 35A1 9BCA 1DE9 7281\",\n\"dannenberg orport=443 \"\n  \"v3ident=0232AF901C31A04EE9848595AF9BB7620D4C5B2E \"\n  \"ipv6=[2001:678:558:1000::244]:443 \"\n  \"193.23.244.244:80 7BE6 83E6 5D48 1413 21C5 ED92 F075 C553 64AC 7123\",\n\"maatuska orport=80 \"\n  \"v3ident=49015F787433103580E3B66A1707A00E60F2D15B \"\n  \"ipv6=[2001:67c:289c::9]:80 \"\n  \"171.25.193.9:443 BD6A 8292 55CB 08E6 6FBE 7D37 4836 3586 E46B 3810\",\n\"Faravahar orport=443 \"\n  \"v3ident=EFCBE720AB3A82B99F9E953CD5BF50F7EEFC7B97 \"\n  \"154.35.175.225:80 CF6D 0AAF B385 BE71 B8E1 11FC 5CFF 4B47 9237 33BC\",\n\"longclaw orport=443 \"\n  \"v3ident=23D15D965BC35114467363C165C4F724B64B4F66 \"\n  \"199.58.81.140:80 74A9 1064 6BCE EFBC D2E8 74FC 1DC9 9743 0F96 8145\",\n\"bastet orport=443 \"\n  \"v3ident=27102BC123E7AF1D4741AE047E160C91ADC76B21 \"\n  \"ipv6=[2620:13:4000:6000::1000:118]:443 \"\n  \"204.13.164.118:80 24E2 F139 121D 4394 C54B 5BCC 368B 3B41 1857 C413\",\n`\n\nexport interface Authority {\n  name: string,\n  orport: number,\n  v3ident?: string,\n  bridge?: boolean,\n  ipv4: string,\n  ipv6?: string,\n  fingerprint: number[]\n}\n\nexport function parseAuthorities() {\n  const lines = auth_dirs\n    .replaceAll('\\n', '')\n    .replaceAll('\\\"  \\\"', '')\n    .slice(0, -1)\n    .split(\",\")\n\n  const authorities = new Array<Authority>(lines.length)\n\n  for (let i = 0; i < lines.length; i++) {\n    const sline = lines[i].slice(1, -1)\n    const authority = parseAuthority(sline)\n    authorities[i] = authority\n  }\n\n  return authorities\n}\n\n\nexport function parseAuthority(line: string) {\n  const [name, ...words] = line.split(\" \")\n\n  const authority: Partial<Authority> = { name }\n\n  for (let i = 0; i < words.length; i++) {\n    const word = words[i]\n\n    if (word === \"bridge\")\n      authority.bridge = true\n    else if (word.startsWith(\"orport=\"))\n      authority.orport = Number(word.slice(\"orport=\".length))\n    else if (word.startsWith(\"v3ident=\"))\n      authority.v3ident = word.slice(\"v3ident=\".length)\n    else if (word.startsWith(\"ipv6=\"))\n      authority.ipv6 = word.slice(\"ipv6=\".length)\n    else if (i === words.length - 11)\n      authority.ipv4 = word\n  }\n\n  authority.fingerprint = words.slice(-10).map(it => parseInt(it, 16))\n\n  if (!authority.name)\n    throw new Error(`Undefined authority name`)\n  if (!authority.orport)\n    throw new Error(`Undefined authority orport`)\n  if (!authority.ipv4)\n    throw new Error(`Undefined authority name`)\n  if (!authority.fingerprint)\n    throw new Error(`Undefined authority fingerprint`)\n  return authority as Authority\n}"],"names":[],"mappings":";;AAAA;;AAEG;AACU,MAAA,SAAS,GAAG,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAmCxB;SAYe,gBAAgB,GAAA;IAC9B,MAAM,KAAK,GAAG,SAAS;AACpB,SAAA,UAAU,CAAC,IAAI,EAAE,EAAE,CAAC;AACpB,SAAA,UAAU,CAAC,QAAQ,EAAE,EAAE,CAAC;AACxB,SAAA,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;SACZ,KAAK,CAAC,GAAG,CAAC,CAAA;IAEb,MAAM,WAAW,GAAG,IAAI,KAAK,CAAY,KAAK,CAAC,MAAM,CAAC,CAAA;AAEtD,IAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACrC,QAAA,MAAM,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAA;AACnC,QAAA,MAAM,SAAS,GAAG,cAAc,CAAC,KAAK,CAAC,CAAA;AACvC,QAAA,WAAW,CAAC,CAAC,CAAC,GAAG,SAAS,CAAA;AAC3B,KAAA;AAED,IAAA,OAAO,WAAW,CAAA;AACpB,CAAC;AAGK,SAAU,cAAc,CAAC,IAAY,EAAA;AACzC,IAAA,MAAM,CAAC,IAAI,EAAE,GAAG,KAAK,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;AAExC,IAAA,MAAM,SAAS,GAAuB,EAAE,IAAI,EAAE,CAAA;AAE9C,IAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACrC,QAAA,MAAM,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAA;QAErB,IAAI,IAAI,KAAK,QAAQ;AACnB,YAAA,SAAS,CAAC,MAAM,GAAG,IAAI,CAAA;AACpB,aAAA,IAAI,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC;AACjC,YAAA,SAAS,CAAC,MAAM,GAAG,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAA;AACpD,aAAA,IAAI,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC;YAClC,SAAS,CAAC,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,MAAM,CAAC,CAAA;AAC9C,aAAA,IAAI,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC;YAC/B,SAAS,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,CAAA;AACxC,aAAA,IAAI,CAAC,KAAK,KAAK,CAAC,MAAM,GAAG,EAAE;AAC9B,YAAA,SAAS,CAAC,IAAI,GAAG,IAAI,CAAA;AACxB,KAAA;IAED,SAAS,CAAC,WAAW,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,EAAE,IAAI,QAAQ,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,CAAA;IAEpE,IAAI,CAAC,SAAS,CAAC,IAAI;AACjB,QAAA,MAAM,IAAI,KAAK,CAAC,CAAA,wBAAA,CAA0B,CAAC,CAAA;IAC7C,IAAI,CAAC,SAAS,CAAC,MAAM;AACnB,QAAA,MAAM,IAAI,KAAK,CAAC,CAAA,0BAAA,CAA4B,CAAC,CAAA;IAC/C,IAAI,CAAC,SAAS,CAAC,IAAI;AACjB,QAAA,MAAM,IAAI,KAAK,CAAC,CAAA,wBAAA,CAA0B,CAAC,CAAA;IAC7C,IAAI,CAAC,SAAS,CAAC,WAAW;AACxB,QAAA,MAAM,IAAI,KAAK,CAAC,CAAA,+BAAA,CAAiC,CAAC,CAAA;AACpD,IAAA,OAAO,SAAsB,CAAA;AAC/B;;;;;;"}